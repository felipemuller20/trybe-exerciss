<!DOCTYPE html>
<html>
   <head>
      <title>Redux basic example</title>
      <script src="https://unpkg.com/redux@latest/dist/redux.min.js"></script>
   </head>
   <body>
      <div>
        Clicked: <span id="value">0</span> times
        <button id="increment">+</button>
        <button id="decrement">-</button>
        <button id="increment-10">Adiciona 10</button>
        <input type='number'id="increment-quantity" placeholder="Digite a quantidade do incremento">
        <input type='number' id='decrement-quantity' placeholder="Digite o decremento">
        Número de cliques: <span id='clickCounter'>X</span>
        Valored adicionados: <span id="addedValues">X</span>
      </div>
      <script>

        const INCREMENT = 'INCREMENT';
        const DECREMENT = 'DECREMENT';
        const INCREMENT_VALUE = 'INCREMENT_VALUE';
        const DECREMENT_VALUE = 'DECREMENT_VALUE';

        const INITIAL_STATE = {
          contador: 0,
          incrementValue: 0,
          decrementValue: 0,
          clickCounts: 0,
          addedValues: [],
        };
        // o reducer é uma função que retorna o novo valor do meu estado global
        // a partir de uma action

        const changeState = (state, action) => {
          const valor = action.type === INCREMENT ? state.incrementValue : state.decrementValue;

          return {
            ...state,
            contador: state.contador + valor,
          }
        }

        function counterReducer(state = INITIAL_STATE, action) {
          switch(action.type) {
            case INCREMENT: 
              // state = state + 1 ❌
              return changeState(state, action);
            case DECREMENT: 
              return changeState(state, action);
            case INCREMENT_VALUE:
              return {...state, incrementValue: action.payload.value};
            case DECREMENT_VALUE:
              return {...state, decrementValue: action.payload.value};
            default:
              return state;
          }
        }

        // Criar a store passando o counterReducer
        const store = Redux.createStore(
          counterReducer,
          window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()
        );

        document
          .querySelector('#increment')
          .addEventListener('click', () => {
            const incrementAction = {
              type: 'INCREMENT',
            }

            store.dispatch(incrementAction);
          })
        
        document
          .querySelector('#decrement')
          .addEventListener('click', () => {
            const decrementAction = {
              type: 'DECREMENT',
            }

            store.dispatch(decrementAction);
          })

        document
          .querySelector('#increment-10')
          .addEventListener('click', () => {
            const increment10Action = {
              type: 'INCREMENT',
              payload: {
                amount: 10
              }
            }

            store.dispatch(increment10Action);
          })

        document
          .querySelector('#increment-quantity')
          .addEventListener('change', () => {
            const action = {
              type: INCREMENT_VALUE,
              payload: {
                value: parseInt(event.target.value),
              }
            }
            store.dispatch(action);
          })

          document
          .querySelector('#decrement-quantity')
          .addEventListener('change', () => {
            const action = {
              type: DECREMENT_VALUE,
              payload: {
                value: parseInt(`-${event.target.value}`),
              }
            }
            store.dispatch(action);
          })



        // pede os dados e atualiza a página
        store.subscribe(() => {
          document.querySelector('#value').innerHTML = store.getState().contador;
        });
      </script>
   </body>
</html>